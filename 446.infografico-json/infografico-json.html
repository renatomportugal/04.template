<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <title>Infografico JSon</title>
  <!-- mobile meta tag -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="Woozy">
	
  <link rel='stylesheet' href='css/bootstrap-4.0.0-beta2.css'>

      
	<!-- MODAL -->
	<link rel="stylesheet" href="css/normalize-5.0.0.min.css">
	<link rel='stylesheet' href='css/bootstrap-3.3.4.min.css'>
	
	<!-- <link rel="stylesheet" href="infografico.css"> -->
	<style>
	  html, body {
		  font: 100% "Lato", sans-serif;
		  font-weight: 300;
		  height: 100%;
		  background-color: #4D4545;
		  background: radial-gradient(circle at 50% 50%, #0a1e1f, #522222);
		}

		h2{
		color: cornflowerblue;
		font-weight: 700;
		text-shadow: 1px 1px 1px #afcce8, 1px 1px 1px #cde2f9;
		}

		h5{
		color: #ad5cc1;
		font-weight: 700;
		}

		p{
		color: silver;
		text-align: justify;
		}

		.blue-bg {
		  color: #c3ff31;
		  height: 100%;
		}

		.circle {
		  font-weight: bold;
		  padding: 15px 20px;
		  border-radius: 50%;
		  background-color: #8dede4;
		  color: #4D4545;
		  max-height: 50px;
		  z-index: 2;
		}

		.how-it-works.row {
		  display: flex;
		}
		.how-it-works.row .col-2 {
		  display: inline-flex;
		  align-self: stretch;
		  align-items: center;
		  justify-content: center;
		}
		.how-it-works.row .col-2::after {
		  content: "";
		  position: absolute;
		  border-left: 3px solid #0062cc;
		  z-index: 1;
		}
		.how-it-works.row .col-2.bottom::after {
		  height: 50%;
		  left: 50%;
		  top: 50%;
		}
		.how-it-works.row .col-2.full::after {
		  height: 100%;
		  left: calc(50% - 3px);
		}
		.how-it-works.row .col-2.top::after {
		  height: 50%;
		  left: 50%;
		  top: 0;
		}

		.timeline div {
		  padding: 0;
		  height: 40px;
		}
		.timeline hr {
		  border-top: 3px solid #0062cc;
		  margin: 0;
		  top: 17px;
		  position: relative;
		}
		.timeline .col-2 {
		  display: flex;
		  overflow: hidden;
		}
		.timeline .corner {
		  border: 3px solid #0062cc;
		  width: 100%;
		  position: relative;
		  border-radius: 15px;
		}

		.timeline .bottom-right-primeiro {
		  left: 50%;
		  top: -50%;
		}

		.timeline .bottom-right {
		  left: calc(50% - 3px);
		  top: -50%;
		}
		.timeline .right-top {
		  left: -50%;
		  top: calc(50% - 3px);
		}
		.timeline .bottom-left {
		  left: -50%;
		  top: -50%;
		}
		.timeline .left-top-primeiro {
		  left: calc(50% - 3px);
		  top: calc(50% - 3px);
		}
		.timeline .left-top {
		  left: calc(50% - 3px);
		  top: calc(50% - 3px);
		}
		.timeline .left-last {
		  left: 50%;
		  top: calc(50% - 3px);
		}
		.timeline .right-last {
			left: calc(-50% + 3px);
		  top: calc(50% - 3px);
		}
	  </style>

	
	<!-- <link rel="stylesheet" href="modal.css"> -->
	<style> 

.linkModal{
color: chartreuse;
}	
	
.bmd-modalButton {
  /*
  display: block;
  margin: 15px auto;
  padding: 5px 15px;
  */
  cursor: pointer;
}

.close-button {
  overflow: hidden;
}

.bmd-modalContent {
  box-shadow: none;
  background-color: transparent;
  border: 0;
}
  
.bmd-modalContent .close {
  font-size: 30px;
  line-height: 30px;
  padding: 7px 4px 7px 13px;
  text-shadow: none;
  opacity: 0.7;
  color:#fff;
}

.bmd-modalContent .close span {
  display: block;
}

.bmd-modalContent .close:hover,
.bmd-modalContent .close:focus {
  opacity: 0.5;
  outline: none;
}

.bmd-modalContent iframe {
  display: block;
  margin: 0 auto;
}

.modal{
width: auto;
margin: auto;
background-color: black;
}

.modal.fade.in {
    top: 1%;
}
	</style>
	
</head>
<script>
	function inicio(){
    img = '[{"src": "image_7150_2e-Hubble-Legacy-Field.jpg","width": "1280px","height": "959px","quadros":["http://example.com 691px 70px 5px solid #0000ff 180px 178px", "http://example.com 692px 307px 3px solid #ff0000 182px 179px", "http://google.com 692px 545px 3px solid #ff00b6 182px 179px", "http://google.com 408px 307px 4px solid #00ff00 182px 179px", "http://google.com 127px 782px 5px solid #668833 182px 177px", "http://google.com 129px 310px 5px solid #ffff00 178px 179px"]}]';
    try {
        if (img != null) {
            var imagens = JSON.parse(img);

            for (let i = 0; i < imagens.length; i++) {
                let imagem = imagens[i];
                //Extrair o array quadros
                for (let j = 0; j < imagem.quadros.length; j++) {
                    const quadro = imagem.quadros[j];
                    var quadroarray = quadro.split(" ");
                    console.log(quadroarray);
                    
                    //Cria a div
                    var quadrodiv = document.createElement("div");
                    var id_div = "quadrodiv_" + j;
                    quadrodiv.setAttribute("id", id_div);
                    //quadrodiv.setAttribute("onclick", "window.location='" + quadroarray[0] + "'");
                    quadrodiv.setAttribute("onclick", "window.open('" + quadroarray[0] + "','_blank')" );
                    quadrodiv.setAttribute("onmouseover", "this.style.cursor='pointer';");
                    quadrodiv.setAttribute("style", "position: absolute;z-index: 30;top: " + quadroarray[1] + ";left: " + quadroarray[2] + ";border: " + quadroarray[3] + " " + quadroarray[4] + " " + quadroarray[5] + ";");
                    //Cria o Canvas
                    var quadrocanvas = document.createElement("canvas");
                    var quadrocanvastexto = document.createTextNode("Use o Google Chrome.");
                    quadrocanvas.appendChild(quadrocanvastexto);
                    var id_canvas = "quadrocanvas_" + j;
                    quadrocanvas.setAttribute("id", id_canvas);
                    quadrocanvas.setAttribute("style", "width: " + quadroarray[6] + ";height: " + quadroarray[7] + ";");
                    //Adiciona div na div image_wrapper
                    document.getElementById("image_wrapper").appendChild(quadrodiv);
                    document.getElementById(id_div).appendChild(quadrocanvas);
                }

                //Prepara o espaço
                var imagemdiv = document.getElementById("imagemdiv");
                imagemdiv.style="display: contents; width: " + imagem.width + "; height: " + imagem.height + ";";

                //Carrega a imagem
                var img = document.getElementById("img");
                img.src = imagem.src;
            }    
        }else{
            console.log("Nada foi recebido.");
        }
    } catch (error) {
        console.log(error);
    }
}
</script>

<body>
<script src='js/jquery-3.1.0.min.js'></script>
<!-- JSON -->  
<script src='js/es6-promise-1.0.0.js'></script>
<script src='js/jsonld-0.3.15.js'></script>
<!-- MODAL -->
<script src='js/bootstrap-3.3.4.min.js'></script>



<button id="lesen">Abrir Texto</button>

<div class="container-fluid blue-bg">
  <div id="container" class="container">
	    <!--
    <h2 class="pb-3 pt-2">Vertical Left-Right Timeline</h2>
	<div id="casa_1" class="row align-items-center how-it-works">
      <div class="col-2 text-center bottom">
        <div class="circle">1</div>
      </div>
      <div class="col-6">
        <h5>Fully Responsive</h5>
        <p>Lorem <span class="bmd-modalButton linkModal" data-toggle="modal" data-bmdSrc="https://player.vimeo.com/video/18539129" data-bmdWidth="500" data-bmdHeight="281" data-target="#myModal">ipsum</span> dolor sit amet, consectetur adipiscing elit. Sed porttitor gravida aliquam. Morbi orci urna, iaculis in ligula et, posuere interdum lectus.</p>
      </div>
	</div>
	
    <div id="casa_2" class="row align-items-center justify-content-end how-it-works">
      <div class="col-6 text-right">
        <h5>Using Bootstrap</h5>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed porttitor gravida aliquam. Morbi orci urna, iaculis in ligula et, posuere interdum lectus.</p>
      </div>
      <div class="col-2 text-center full">
        <div class="circle">2</div>
      </div>
	</div>

    <div id="casa_3" class="row align-items-center how-it-works">
      <div class="col-2 text-center top">
        <div class="circle">3</div>
      </div>
      <div class="col-6">
        <h5>Now with Pug and Sass</h5>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed porttitor gravida aliquam. Morbi orci urna, iaculis in ligula et, posuere interdum lectus.</p>
      </div>
	</div>
-->
  </div>
</div>

	<script>
		

jQuery(document).ready(function(){
	
});


	</script>
<script>
$(document).ready(function() {
	

    $("#lesen").click(function() {
        $.ajax({
            url : "abrirTxt.txt",
            dataType: "text",
            success : function (data) {

                // $("#text").html(data);
				
				inicio(data);

				(function($) {
					$.fn.bmdIframe = function( options ) {
						//console.log("oi")
						var self = this;
						var settings = $.extend({
							classBtn: '.bmd-modalButton',
							defaultW: 640,
							defaultH: 360
						}, options );
					
						$(settings.classBtn).on('click', function(e) {
						var allowFullscreen = $(this).attr('data-bmdVideoFullscreen') || false;
						
						var dataVideo = {
							'src': $(this).attr('data-bmdSrc'),
							'height': $(this).attr('data-bmdHeight') || settings.defaultH,
							'width': $(this).attr('data-bmdWidth') || settings.defaultW
						};
						
						if ( allowFullscreen ) dataVideo.allowfullscreen = "";
						
						// stampiamo i nostri dati nell'iframe
						$(self).find("iframe").attr(dataVideo);
						});
					
						// se si chiude la modale resettiamo i dati dell'iframe per impedire ad un video di continuare a riprodursi anche quando la modale è chiusa
						this.on('hidden.bs.modal', function(){
						$(this).find('iframe').html("").attr("src", "");
						});
					
						return this;
					};
				
				})(jQuery);

				jQuery("#myModal").bmdIframe();

				

            }
        });
    });
});

var json;

function inicio(data){
	try{
		if (data != null) {
            json = JSON.parse(data);
			console.log(json);

			//Titulo
			var h2 = document.createElement("h2");
			h2.setAttribute("class", "pb-3 pt-2");
			var h2texto = document.createTextNode(json.titulo);
			h2.appendChild(h2texto);
			document.getElementById("container").appendChild(h2);

			const casas = json.casas;
			const qnt_casas = casas.length;
			//console.log(qnt_casas)
			//Casa1
			/*
			<div id="casa_1" class="row align-items-center how-it-works">
				<div id="casa_1_col2" class="col-2 text-center bottom">
					<div class="circle">1</div>
				</div>
				<div id="casa_1_col6" class="col-6">
					<h5>Fully Responsive</h5>
					<p>Lorem <span class="bmd-modalButton linkModal" data-toggle="modal" data-bmdSrc="https://player.vimeo.com/video/18539129" data-bmdWidth="500" data-bmdHeight="281" data-target="#myModal">ipsum</span> dolor sit amet, consectetur adipiscing elit. Sed porttitor gravida aliquam. Morbi orci urna, iaculis in ligula et, posuere interdum lectus.</p>
				</div>
			</div>
			*/

			//seletor de classes
			var div_impar_1_class;
			var div_impar_2_class;
			var div_par_3_class;
			var div10_class;
			var div13_class;

			div_impar_1_class = "row align-items-center how-it-works";

			//Se for único não tem bottom
			if(casas.length == 1){
				div_impar_2_class = "col-2 text-center";
			}else{
				div_impar_2_class = "col-2 text-center bottom";
			}
			
			//k inicia ímpar, maior que 2 para fazer operação com módulo
			var k = 3;
			for (let i = 0; i < casas.length; i++) {
				
				
				var casa = casas[i];
				//Não executa na primeira vez
				if (i > 0) {
					//identifica o último, após excluir o primeiro
					if (i == (qnt_casas - 1)) {
						div_impar_2_class = "col-2 text-center top";
						div_par_3_class = "col-2 text-center top";
						div10_class = "corner right-last";
						div13_class = "corner left-last";
					}else{
						div_impar_2_class = "col-2 text-center full";
						div_par_3_class = "col-2 text-center full";
						div10_class = "corner right-top";
						div13_class = "corner left-top";
					}

					//console.log("i = " + i)
					let j = i + 1;
					//console.log("j = " + j)
					if (!(j % 2)) {
						//Executa se for ímpar - ESQUERDA PARA DIREITA
						// <div id="esq_dir_1" class="row timeline">
						// 	<div id="esq_dir_1_col_2" class="col-2">
						// 		<div class="corner bottom-right"></div>
						// 	</div>
						// 	<div id="esq_dir_1_col_8" class="col-8">
						// 		<hr/>
						// 	</div>
						// 	<div id="esq_dir_1_col_2b" class="col-2">
						// 		<div class="corner right-top"></div>
						// 	</div>
						// </div>
						if	(j == 2){
							div_7_class = "corner bottom-right-primeiro";
						}else{
							div_7_class = "corner bottom-right";
						}

						var div5 = document.createElement("div");
						var div5_id = "esq_dir_" + i;
						div5.setAttribute("id", div5_id);
						div5.setAttribute("class", "row timeline");
						document.getElementById("container").appendChild(div5);

						var div6 = document.createElement("div");
						var div6_id = div5_id + "_col_2";
						div6.setAttribute("id", div6_id);
						div6.setAttribute("class", "col-2");
						document.getElementById(div5_id).appendChild(div6);

						var div7 = document.createElement("div");
						div7.setAttribute("class", div_7_class);
						document.getElementById(div6_id).appendChild(div7);

						var div8 = document.createElement("div");
						var div8_id = div5_id + "_col_8";
						div8.setAttribute("id", div8_id);
						div8.setAttribute("class", "col-8");
						document.getElementById(div5_id).appendChild(div8);

						var hr = document.createElement("hr");
						document.getElementById(div8_id).appendChild(hr);

						var div9 = document.createElement("div");
						var div9_id = div5_id + "_col_2b";
						div9.setAttribute("id", div9_id);
						div9.setAttribute("class", "col-2");
						document.getElementById(div5_id).appendChild(div9);

						var div10 = document.createElement("div");
						div10.setAttribute("class", div10_class);
						document.getElementById(div9_id).appendChild(div10);

						//_CASAS PARES
						//div1_class = "row align-items-center justify-content-end how-it-works";
						//  <div id="casa_2" class="row align-items-center justify-content-end how-it-works">
						// 	<div class="col-6 text-right">
						// 		<h5>Using Bootstrap</h5>
						// 		<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed porttitor gravida aliquam. Morbi orci urna, iaculis in ligula et, posuere interdum lectus.</p>
						// 	</div>
						// 	<div class="col-2 text-center full">
						// 		<div class="circle">2</div>
						// 	</div>
						// </div>

					}else{
						if	(j == 3){
							div13_class = "corner left-top-primeiro";
						}
						if (i == (qnt_casas - 1)) {
							div13_class = "corner left-last";
						}

						//Executa se for par - DIREITA PARA ESQUERDA
						// <div id="dir_esq_1" class="row timeline">
						// 	<div id="dir_esq_1_col_2" class="col-2">
						// 		<div class="corner left-top"></div>
						// 	</div>
						// 	<div id="dir_esq_1_col_8" class="col-8">
						// 		<hr/>
						// 	</div>
						// 	<div id="dir_esq_1_col_2b" class="col-2">
						// 		<div class="corner bottom-left"></div>
						// 	</div>
						// </div>

						var div11 = document.createElement("div");
						var div11_id = "dir_esq_" + i;
						div11.setAttribute("id", div11_id);
						div11.setAttribute("class", "row timeline");
						document.getElementById("container").appendChild(div11);

						var div12 = document.createElement("div");
						var div12_id = div11_id + "_col_2";
						div12.setAttribute("id", div12_id);
						div12.setAttribute("class", "col-2");
						document.getElementById(div11_id).appendChild(div12);

						var div13 = document.createElement("div");
						div13.setAttribute("class", div13_class);
						console.log(div13_class);
						document.getElementById(div12_id).appendChild(div13);

						var div14 = document.createElement("div");
						var div14_id = div11_id + "_col_8";
						div14.setAttribute("id", div14_id);
						div14.setAttribute("class", "col-8");
						document.getElementById(div11_id).appendChild(div14);

						let hr = document.createElement("hr");
						document.getElementById(div14_id).appendChild(hr);

						var div15 = document.createElement("div");
						var div15_id = div11_id + "_col_2b";
						div15.setAttribute("id", div15_id);
						div15.setAttribute("class", "col-2");
						document.getElementById(div11_id).appendChild(div15);

						var div16 = document.createElement("div");
						div16.setAttribute("class", "corner bottom-left");
						document.getElementById(div15_id).appendChild(div16);

						//_CASAS ÍMPARES
						//div1_class = "row align-items-center how-it-works";
					}	
				}

				if (k % 2) {
					//console.log("impar: " + k);
					var div_impar_1 = document.createElement("div");
					var div_impar_1_id = "casa_impar_" + casa.casaNumero;
					div_impar_1.setAttribute("id", div_impar_1_id);
					div_impar_1.setAttribute("class", div_impar_1_class);
					document.getElementById("container").appendChild(div_impar_1);

					var div_impar_2 = document.createElement("div");
					var div_impar_2_id = "casa_impar_" + casa.casaNumero + "_col2";
					div_impar_2.setAttribute("id", div_impar_2_id);
					div_impar_2.setAttribute("class", div_impar_2_class);
					document.getElementById(div_impar_1_id).appendChild(div_impar_2);

					var div_impar_3 = document.createElement("div");
					div_impar_3.setAttribute("class", "circle");
					var div_impar_3_texto = document.createTextNode(casa.casaNumero);
					div_impar_3.appendChild(div_impar_3_texto);
					document.getElementById(div_impar_2_id).appendChild(div_impar_3);

					var div_impar_4_id = "casa_impar_" + casa.casaNumero + "_col6";
					var div_impar_4 = document.createElement("div");
					div_impar_4.setAttribute("id", div_impar_4_id);
					div_impar_4.setAttribute("class", "col-6");
					document.getElementById(div_impar_1_id).appendChild(div_impar_4);

					var h5 = document.createElement("h5");
					var h5texto = document.createTextNode(casa.casaTitulo);
					h5.appendChild(h5texto);
					document.getElementById(div_impar_4_id).appendChild(h5);

					var p = document.createElement("p");
					p.innerHTML = casa.casaTexto;
					document.getElementById(div_impar_4_id).appendChild(p);
				}else{
					//console.log("par: " + k);
					var div_par_1 = document.createElement("div");
					var div_par_1_id = "casa_par_" + casa.casaNumero;
					div_par_1.setAttribute("id", div_par_1_id);
					div_par_1.setAttribute("class", "row align-items-center justify-content-end how-it-works");
					document.getElementById("container").appendChild(div_par_1);

					var div_par_2 = document.createElement("div");
					var div_par_2_id = "casa_par_" + casa.casaNumero + "_col6";
					div_par_2.setAttribute("id", div_par_2_id);
					div_par_2.setAttribute("class", "col-6 text-right");
					document.getElementById(div_par_1_id).appendChild(div_par_2);

					var h5 = document.createElement("h5");
					var h5texto = document.createTextNode(casa.casaTitulo);
					h5.appendChild(h5texto);
					document.getElementById(div_par_2_id).appendChild(h5);

					var p = document.createElement("p");
					p.innerHTML = casa.casaTexto;
					document.getElementById(div_par_2_id).appendChild(p);

					var div_par_3 = document.createElement("div");
					var div_par_3_id = "casa_par_" + casa.casaNumero + "_col2";
					div_par_3.setAttribute("id", div_par_3_id);
					div_par_3.setAttribute("class", div_par_3_class);
					document.getElementById(div_par_1_id).appendChild(div_par_3);

					var div_par_4 = document.createElement("div");
					div_par_4.setAttribute("class", "circle");
					var div_par_4_texto = document.createTextNode(casa.casaNumero);
					div_par_4.appendChild(div_par_4_texto);
					document.getElementById(div_par_3_id).appendChild(div_par_4);

					

					
				}
				
				k++;
			}
		}
	}catch (error) {
		console.log(error);
	}
}

</script>
	
<!-- MODAL -->
<div class="modal fade" id="myModal">
	<div class="modal-dialog">
		<div class="modal-content bmd-modalContent">
			<div class="modal-body">
				<div class="close-button">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="pararModal()"><span aria-hidden="true">&times;</span></button>
				</div>
				<div class="embed-responsive embed-responsive-16by9">
					<iframe id="video" class="embed-responsive-item" frameborder="0"></iframe>
				</div>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script>
	function pararModal(){
		$('.modal').find('iframe').html("").attr("src", "");
	}
</script>

</body>
</html>
